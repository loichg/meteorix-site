
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../env/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Algorithme de détection - Meteorix</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#algorithme-de-detection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Meteorix" class="md-header__button md-logo" aria-label="Meteorix" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Meteorix
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Algorithme de détection
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Meteorix" class="md-nav__button md-logo" aria-label="Meteorix" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Meteorix
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Algorithme de détection
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Algorithme de détection
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#compression-video" class="md-nav__link">
    <span class="md-ellipsis">
      Compression vidéo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filtrage-des-vecteurs" class="md-nav__link">
    <span class="md-ellipsis">
      Filtrage des vecteurs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filtrage des vecteurs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motion-vector-extractor" class="md-nav__link">
    <span class="md-ellipsis">
      Motion Vector Extractor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-de-filtres" class="md-nav__link">
    <span class="md-ellipsis">
      Application de filtres
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-c" class="md-nav__link">
    <span class="md-ellipsis">
      API C++
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#piste-damelioration" class="md-nav__link">
    <span class="md-ellipsis">
      Piste d'amélioration
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environnement d'éxécution
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../param/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Paramètre de compression
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../docu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation pour Flownet
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../inf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inférence de Flownet
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../gen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Génération d'une base de données
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../conclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conclusion
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Utilisation%20FFMPEG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utilisation de ffmpeg dans le projet Meteorix
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Utilisation%20MVE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Détection des météores en utilisant mv-extractor
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../implem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implémentation Flownet sur em780
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../annexes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Résultats de FlowNetCorr
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#compression-video" class="md-nav__link">
    <span class="md-ellipsis">
      Compression vidéo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filtrage-des-vecteurs" class="md-nav__link">
    <span class="md-ellipsis">
      Filtrage des vecteurs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Filtrage des vecteurs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motion-vector-extractor" class="md-nav__link">
    <span class="md-ellipsis">
      Motion Vector Extractor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-de-filtres" class="md-nav__link">
    <span class="md-ellipsis">
      Application de filtres
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-c" class="md-nav__link">
    <span class="md-ellipsis">
      API C++
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#piste-damelioration" class="md-nav__link">
    <span class="md-ellipsis">
      Piste d'amélioration
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="algorithme-de-detection">Algorithme de détection</h1>
<p>L’objectif ici est de compresser les images récupérées par le nanosatellite afin d’obtenir les mouvements dans l’image et ainsi déterminer s’il y a un météore ou non.</p>
<h2 id="compression-video">Compression vidéo</h2>
<p>L’idée est alors de détourner l’utilisation de la compression inter-image. En effet, la compression vidéo est une technique permettant de réduire la taille des fichiers vidéo tout en conservant une qualité d’image satisfaisante. Elle repose sur l’exploitation des redondances spatiales et temporelles afin de minimiser la quantité de données nécessaires à la reconstruction des images.</p>
<p>Les vidéos compressées sont généralement constituées de trois types de trames :</p>
<ul>
<li><strong>I-Frames (Intra-coded Frames)</strong> : Trames autonomes qui ne dépendent d’aucune autre image</li>
<li><strong>P-Frames (Predicted Frames)</strong> : Trames prédites à partir d’une image précédente, ne stockant que les différences détectées</li>
<li><strong>B-Frames (Bidirectionally Predicted Frames)</strong> : Trames prédites en utilisant à la fois des images précédentes et suivantes, permettant une compression plus efficace</li>
</ul>
<p>Lors de la lecture d’une vidéo, le décodeur reconstruit chaque image en combinant ces différentes trames. Ce procédé est implémenté dans divers codecs tels que H.264, H.265, MPEG-4 Part 2. Ainsi nous allons récupérer et analyser ces vecteurs pour déterminer s’il y a ou non un météore présent sur l’image. De plus, la trajectoire d’un météore est rectiligne ce qui fait qu’il est facilement identifiable si le bruit de la vidéo est faible.</p>
<p><img alt="Représentation d’un météore" src="../figure2.png" /><br />
<em>Représentation d’un météore</em></p>
<p>Sur l’image ci dessus, nous pouvons voir un météore sur la droite, se déplaçant vers le bas. Dans cette vidéo le météore est assez simple à détecter du fait du fond noir de la vidéo et la présence du météore sur de nombreuses images successives.</p>
<p>En pratique nous pourrions être confrontés à plusieurs problèmes, d’une part le météore pourrait n’apparaître que dans une seule image s’il se déplace trop rapidement (la caméra sur le nanosatellite filmera en 25 frames/s). D’autre part, le fond de la vidéo serait trop bruité, par des nuages, éclairs ou étoiles ce qui engendrerait une compression difficile à analyser.</p>
<p>Par exemple, en pratique sur l’image suivante, les nuages rendent la détection du météore compliquée en ajoutant du bruit.</p>
<p><img alt="Représentation d’un météore avec nuages" src="../figure3.png" /><br />
<em>Représentation d’un météore</em></p>
<h2 id="filtrage-des-vecteurs">Filtrage des vecteurs</h2>
<h3 id="motion-vector-extractor">Motion Vector Extractor</h3>
<p>Pour récupérer les vecteurs nous allons utiliser l’outil <strong>Motion Vector Extractor</strong>. Cet outil extrait les images, les vecteurs de mouvement, le type des images des vidéos encodées en H.264 ou MPEG-4. Pour chaque image, on obtient donc :</p>
<ul>
<li>L’image décodée au format RGB</li>
<li>Les vecteurs de mouvement</li>
<li>Le type de l’image : I, P ou B</li>
</ul>
<p>De plus, une API est disponible et bien documentée en Python ainsi qu’une en C++. Pour faire la compression, le logiciel FFMPEG est utilisé en arrière-plan. Par la suite nous utiliserons FFMPEG pour décoder des vidéos, compresser des images en jouant sur les paramètres de compression ou encore conserver uniquement une partie d’une vidéo en temps et espace.</p>
<h3 id="application-de-filtres">Application de filtres</h3>
<p>Dans cette partie nous allons montrer les résultats obtenus avec l’API Python.</p>
<p>Le programme initial de mv-extractor nous fournit déjà une détection de mouvements. Cependant celui-ci ne filtre aucun vecteur, il nous est donc difficile d’identifier le météore.</p>
<p>Nous cherchons à trouver une solution pour conserver uniquement les vecteurs intéressants, c’est à dire ceux qui décrivent le mouvement du météore.</p>
<p>Nous pouvons conserver les vecteurs avec une norme assez importante pour éliminer le bruit et garder l’essentiel du mouvement. Pour cela on suppose que la norme des vecteurs décrivant le météore est supérieure à celle du bruit.</p>
<p>L’idée vient du fait que nous avons remarqué que lors de la compression, le météore est généralement décrit par plusieurs vecteurs. Ainsi nous pouvons conserver uniquement les vecteurs qui possèdent des voisins assez proches et en nombre suffisants. Pour cela on peut utiliser le module <code>NearestNeighbors</code> de Python qui permet de trouver les voisins les plus proches. Nous conservons le vecteur s’il a un nombre suffisant de voisins dans un cercle de rayon fixé. Ce cercle a pour origine l’extrémité finale du vecteur.</p>
<p>Un troisième filtre pouvant être appliqué est spécifique au météore, en effet comme dit précédemment un météore a un mouvement rectiligne. Ainsi après avoir conservé les zones avec du mouvement on filtre en choisissant celles où les vecteurs ont la même direction.</p>
<p>Nous avons commencé par tester nos filtres sur un extrait du court métrage <em>Big Buck Bunny</em> car le mouvement est assez simple à analyser.</p>
<p><img alt="Filtre sur la norme, zone et angle" src="../figure4.png" />  </p>
<p>Nous pouvons remarquer qu’en combinant le filtre sur la norme et la zone cela permet de conserver les parties du lapin en mouvement telles que les bras ou les oreilles. En revanche rajouter le filtre sur les angles des vecteurs n’a pas d’utilité dans ce cas-ci.</p>
<p>Faisons la même chose sur une vidéo de météore.</p>
<p><img alt="Sans filtre" src="../figure5.png" />  </p>
<p>Dès l’application du filtre sur la norme et la zone nous arrivons à isoler le météore. En revanche dans la même vidéo il y a un éclair qui, même en appliquant les 3 filtres, reste visible. Nous pourrions appliquer des filtres plus forts mais nous risquons de ne plus détecter le météore.</p>
<p><img alt="Image de météore" src="../figure6.png" /><br />
<em>Image de météore</em></p>
<p>Par la suite, un algorithme de type <em>knapsack</em> pourra être implémenté. L’idée serait de maximiser une zone en faisant la somme des normes des vecteurs vitesse tout en minimisant le nombre de vecteurs utilisés et ainsi obtenir la zone de plus forte densité.</p>
<h2 id="api-c">API C++</h2>
<p>Notre projet ayant pour objectif d’utiliser le moins d’énergie possible, nous avons choisi de traduire le code Python en C++, ce dernier étant un langage de plus bas niveau et plus performant.</p>
<p>Tout comme le programme Python, nous avons amélioré l’API C++ en implémentant des fonctions permettant de filtrer les vecteurs selon leur norme, leur nombre de voisins, et d’éliminer tous les vecteurs isolés.
Pour réaliser cela, il est nécessaire d’installer préalablement les bibliothèques OpenCV et FFMPEG.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo apt-get update
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>sudo apt-get install libavcodec-dev libavformat-dev libavutil-dev libswscale-dev libopencv-dev
</span></code></pre></div>
<p>Nous avons aussi ajouté un Makefile sur mv-extractor pour que la compilation soit automatique.</p>
<p>Pour lancer le programme il suffit d’exécuter la commande :</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>./main -v input.mp4 -m -r 20.0 -n 10 -p 1 -V 1 -d output/
</span></code></pre></div>
<p>Nous avons ajouté une fonction generate_timestamp_folder() qui utilise les fonctionnalités de la bibliothèque &lt;\ctime&gt; afin de générer une chaîne au format "YYYYMMDD_HHMMSS".</p>
<p>Pour la commande d’exécution voici la liste des options disponibles :</p>
<p>• -m : Seuil de magnitude.
• -r : Rayon de proximité.
• -n : Nombre minimum de voisins requis.
• -p : Prévisualisation.
• -v : Mode verbeux.
• -h : Afficher l’aide.</p>
<p>Enfin, nous avons comparé les temps d’exécution des versions Python et C++ en variant la norme minimale des vecteurs à conserver. C’est-à-dire qu’il y aura de plus en plus de vecteurs à supprimer mais moins à imprimer sur l’image.</p>
<p><img alt="Comparaison du temps d’exécution du programme Python vs C++" src="../figure7.png" />  </p>
<p>Comme attendu, la version C++ est nettement plus performante que celle en Python. Elle est presque 100 fois plus rapide que la version Python.</p>
<h2 id="piste-damelioration">Piste d'amélioration</h2>
<p>Pour optimiser davantage l´algorithme de d´etection de m´eteores et de filtrer plus efficacement
les mouvements qui ont lieu sur les images, on pourrait envisager le ciblage sur le GPU embarqu´e
qui pourrait acc´el´erer significativement les calculs, notamment pour le traitement des nombreuses
videos, demandant beaucoup d’´energie. On pourrait egalement impl´ementer une fonction pour filtrer
plusieurs images successives qui sont obtenues <code>a partir d’une sequence vid´eos, ce qui permettrait
d’affiner la detection en ayant une precision bien meilleure sur la trajectoire des meteores et leurs
caracteristiques. Enfin, on pourrait aussi augmenter le nombre de videos test´ees avec des param</code>etres
vari´es , cela permettrait en particulier d’enrichir la base de donn´ees pour l’analyse fonctionnelle PCA,
am´eliorant le mod`ele. Ces pistes donneraient alors une automatisation plus efficace et precise de la
detection de meteores.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>