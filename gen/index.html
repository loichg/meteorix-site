
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../inf/">
      
      
        <link rel="next" href="../conclusion/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Génération d'une base de données - Meteorix</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#generation-dune-base-de-donnees" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Meteorix" class="md-header__button md-logo" aria-label="Meteorix" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Meteorix
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Génération d'une base de données
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Meteorix" class="md-nav__button md-logo" aria-label="Meteorix" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Meteorix
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithme de détection
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environnement d'éxécution
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../param/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Paramètre de compression
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../docu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation pour Flownet
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../inf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inférence de Flownet
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Génération d'une base de données
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Génération d'une base de données
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#motivations-et-idee-generale" class="md-nav__link">
    <span class="md-ellipsis">
      Motivations et idée générale
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-dune-paire-dimages" class="md-nav__link">
    <span class="md-ellipsis">
      Génération d'une paire d'images
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Génération d&#39;une paire d&#39;images">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#translation-du-background" class="md-nav__link">
    <span class="md-ellipsis">
      Translation du background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mouvement-du-motif" class="md-nav__link">
    <span class="md-ellipsis">
      Mouvement du motif
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generation-du-flot-optique-associe" class="md-nav__link">
    <span class="md-ellipsis">
      Génération du flot optique associé
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../conclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conclusion
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Utilisation%20FFMPEG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utilisation de ffmpeg dans le projet Meteorix
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Utilisation%20MVE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Détection des météores en utilisant mv-extractor
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../implem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Implémentation Flownet sur em780
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../annexes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Résultats de FlowNetCorr
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#motivations-et-idee-generale" class="md-nav__link">
    <span class="md-ellipsis">
      Motivations et idée générale
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-dune-paire-dimages" class="md-nav__link">
    <span class="md-ellipsis">
      Génération d'une paire d'images
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Génération d&#39;une paire d&#39;images">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#translation-du-background" class="md-nav__link">
    <span class="md-ellipsis">
      Translation du background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mouvement-du-motif" class="md-nav__link">
    <span class="md-ellipsis">
      Mouvement du motif
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generation-du-flot-optique-associe" class="md-nav__link">
    <span class="md-ellipsis">
      Génération du flot optique associé
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="generation-dune-base-de-donnees">Génération d'une base de données</h1>
<h2 id="motivations-et-idee-generale">Motivations et idée générale</h2>
<p>Comme expliqué plus haut dans "documentation pour FlowNet", FlowNetSimple a été entraîné à partir d'un dataset de synthèse "FlyingChairs". Ce dataset correspond peu à un environnement spatial utile pour notre mission. Les limites de ce dataset sont les suivantes :</p>
<ul>
<li>le fond des images utilisées : paysages terrestre (paysage de montagne par exemple) versus paysage spatial</li>
<li>mouvement des chaises : translations et rotations versus mouvement du météore : rectiligne uniquement</li>
<li>amplitude du mouvement des chaises différente de l'amplitude du mouvement des météores</li>
<li>taille des objets : une chaise est bien plus grande qu'un météore</li>
</ul>
<p><img alt="Exemple d'une paire d'images issue de &quot;FlyingChairs&quot;" src="../figure20.png" />  </p>
<p>Utiliser un autre dataset plus spécialisé (dans la tâche de la mission) sur lequel entrainer le réseau nous a paru naturel. Ce nouveau dataset spécialisé sera, tout comme "FlyingChairs", synthétique et s'appuiera sur une petite base de données de 140 vidéos de météores capturés depuis l'espace.</p>
<p><strong>Idée générale</strong> : Dans un premier temps, on extrait à partir de la base de données de 140 vidéos 2 types de choses : les paysages spatiaux (qui joueront le rôle de "background" par la suite) et les météores (qui joueront le rôle de motifs à coller par la suite). Une fois que nous avons constitué 2 banques de données avec d'un côté les backgrounds et de l'autre les motifs, on génère des paires d'images aléatoires en collant un motif sur un background. Enfin, on génère le fichier ".flo" associé à chaque paire qui correspond au flot optique entre les 2 images de la paire. Ce dernier fichier jouera le rôle de "Ground Truth" (GT) dans l'apprentissage.</p>
<p><strong>Remarque</strong> : Pour constituer la banque des motifs, on cherche le moment dans chaque vidéo où le météore est le plus visible, on fait un arrêt sur image et on détoure le météore.</p>
<h2 id="generation-dune-paire-dimages">Génération d'une paire d'images</h2>
<p>Pour que le dataset soit le plus réaliste possible on a introduit 2 types de mouvements dans les paires d'images : le mouvement de translation du background (qui traduit le déplacement de la caméra) et le mouvement rectiligne du motif plus ample que la translation du background (correspond au déplacement du météore).</p>
<p>Pour commencer la génération, on choisit aléatoirement : le background parmi une banque de 275 images et le motif parmi une banque de 50 images. L'objectif est donc de créer une paire de 2 images : imageA et imageB à partir du background et du motif choisis.</p>
<p><img alt="Exemple de background" src="../figure21.png" />  </p>
<h3 id="translation-du-background">Translation du background</h3>
<p>Afin d'introduire un mouvement de translation pour le fond, le background est de base plus grand que la taille finale de la paire d'images. Cela nous permet d'effectuer une translation.</p>
<p><img alt="Illustration de la translation du background" src="../figure22.png" />  </p>
<p>L'imageA se situe toujours au centre du background. L'imageB est l'image recadrée (de même taille que l'imageA) suivant la translation induite par l'angle θ.<br />
Ici l'angle θ est choisi aléatoirement tout comme l'amplitude de déplacement entre l'imageA et l'imageB (c'est-à-dire la norme du vecteur de déplacement). En pratique, on fait varier l'amplitude de déplacement entre 0 et 2 pixels. Dans 40% des cas l'amplitude vaut 0, pour le reste des cas l'amplitude vaut 2 pixels.</p>
<h3 id="mouvement-du-motif">Mouvement du motif</h3>
<p>Après avoir généré un déplacement pour le background, il est nécessaire de coller le motif sur l'imageA et de lui créer un déplacement pour ensuite répercuter celui-ci sur l'imageB. Pour générer des mouvements de météores diversifiés, on procède de la manière suivante :</p>
<ul>
<li>on choisit une position initiale aléatoire du météore sur l'imageA (suivant une loi uniforme sur la largeur et la hauteur)</li>
<li>on choisit une direction de déplacement du météore aléatoire suivant l'angle α (loi uniforme)</li>
<li>on choisit une amplitude de déplacement aléatoire du météore (loi uniforme) entre 4 et 10 pixels.</li>
</ul>
<p><strong>Remarque</strong> : on introduit un padding pour la position initiale afin d'éviter que le météore soit sur le bord de l'image.</p>
<p><img alt="Illustration du mouvement du motif" src="../figure23.png" />  </p>
<p>Finalement, pour obtenir l'imageA on colle le motif à la position initiale. Pour obtenir l'imageB, on colle le motif à la position initiale + le déplacement du motif en tenant compte du déplacement du background (déterminé précédemment).</p>
<p><img alt="Exemple d'une paire obtenue à partir du background et du motif sélectionnés" src="../figure24.png" />  </p>
<h3 id="generation-du-flot-optique-associe">Génération du flot optique associé</h3>
<p>Après avoir entièrement déterminé le mouvement du background ainsi que celui du motif, on peut facilement calculer le flot optique associé à la paire d'images car on connaît le déplacement de chaque pixel.</p>
<p><img alt="Flot optique obtenu à partir de la paire exemple" src="../figure25.png" />  </p>
<p>Dans cet exemple, θ vaut environ 270° tandis que α vaut environ 0°.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>